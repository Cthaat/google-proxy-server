# Google Maps APIæœ¬åœ°ä»£ç†æœåŠ¡å™¨ - å®Œæ•´æ–‡æ¡£åˆé›†

> ğŸ“– **æ–‡æ¡£è¯´æ˜**: æœ¬æ–‡æ¡£åˆå¹¶äº†æ‰€æœ‰é¡¹ç›®çš„MDæ–‡æ¡£æ–‡ä»¶ï¼ŒåŒ…å«å®Œæ•´çš„ä½¿ç”¨æŒ‡å—ã€Dockeréƒ¨ç½²è¯´æ˜ã€æ›´æ–°æ—¥å¿—å’Œé¡¹ç›®å®ŒæˆçŠ¶æ€ã€‚

---

## ğŸ“‘ æ–‡æ¡£ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°ä¸å¿«é€Ÿå¼€å§‹](#1-é¡¹ç›®æ¦‚è¿°ä¸å¿«é€Ÿå¼€å§‹)
2. [å¯†ç è®¤è¯é…ç½®](#2-å¯†ç è®¤è¯é…ç½®)
3. [Dockeréƒ¨ç½²è¯´æ˜](#3-dockeréƒ¨ç½²è¯´æ˜)
4. [æ›´æ–°æ—¥å¿—](#4-æ›´æ–°æ—¥å¿—)
5. [é¡¹ç›®å®ŒæˆçŠ¶æ€æ€»ç»“](#5-é¡¹ç›®å®ŒæˆçŠ¶æ€æ€»ç»“)

---

# 1. é¡¹ç›®æ¦‚è¿°ä¸å¿«é€Ÿå¼€å§‹

> ğŸš€ **æœ€æ–°æ›´æ–° (2025å¹´5æœˆ27æ—¥)**
> - âœ… **ç«¯å£å‡çº§**: ä»3001å‡çº§åˆ°3002ç«¯å£
> - âœ… **åŒ…ç®¡ç†å™¨åˆ‡æ¢**: ä»npmåˆ‡æ¢åˆ°yarnï¼Œæå‡ä¾èµ–ç®¡ç†æ•ˆç‡
> - âœ… **æ™ºèƒ½IPæ£€æµ‹**: è‡ªåŠ¨æ£€æµ‹çœŸå®æœ¬åœ°IPåœ°å€ï¼Œæ’é™¤VPNè™šæ‹Ÿç½‘ç»œ
> - âœ… **å¯†ç è®¤è¯**: å®Œæ•´çš„APIå¯†ç ä¿æŠ¤æœºåˆ¶ï¼Œæ”¯æŒ4ç§è®¤è¯æ–¹å¼
> - âœ… **POSTè·¯ç”±æ”¯æŒ**: æ‰€æœ‰APIç«¯ç‚¹ç°å·²æ”¯æŒPOSTè¯·æ±‚æ–¹å¼
> - âœ… **å¾®ä¿¡å°ç¨‹åºå…¼å®¹**: å®Œå…¨å…¼å®¹å¾®ä¿¡å°ç¨‹åºwx.requestè°ƒç”¨æ–¹å¼
> - âœ… **å…¨é¢æµ‹è¯•**: åŒ…å«å¯†ç è®¤è¯ã€POSTç«¯ç‚¹ã€å¾®ä¿¡å…¼å®¹æ€§ç­‰å®Œæ•´æµ‹è¯•å¥—ä»¶

## ğŸ“‹ ç›®å½•ç´¢å¼•
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [è¯¦ç»†é…ç½®](#è¯¦ç»†é…ç½®)
- [å¾®ä¿¡å°ç¨‹åºé…ç½®](#å¾®ä¿¡å°ç¨‹åºé…ç½®)
- [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)
- [APIä½¿ç”¨ç¤ºä¾‹](#apiä½¿ç”¨ç¤ºä¾‹)
- [ç”Ÿäº§éƒ¨ç½²](#ç”Ÿäº§éƒ¨ç½²)

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```powershell
# è¿›å…¥ä»£ç†æœåŠ¡å™¨ç›®å½•
cd google-proxy-server

# å®‰è£…Node.jsä¾èµ–ï¼ˆæ¨èä½¿ç”¨yarnï¼‰
yarn install

# æˆ–ä½¿ç”¨npm
npm install
```

### 2. é…ç½®APIå¯†é’¥

ç¼–è¾‘ `server.js` æ–‡ä»¶ï¼Œæ›¿æ¢ä¸ºæ‚¨çš„Google Maps APIå¯†é’¥ï¼š

```javascript
const API_KEY = 'YOUR_ACTUAL_GOOGLE_MAPS_API_KEY';
```

### 3. å¯åŠ¨æœåŠ¡å™¨

**æ–¹æ³•ä¸€ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰**
```powershell
# Windows PowerShell
.\start.ps1

# æˆ–è€…ä½¿ç”¨æ‰¹å¤„ç†æ–‡ä»¶
.\start.bat
```

**æ–¹æ³•äºŒï¼šç›´æ¥å¯åŠ¨**
```powershell
yarn start
# æˆ–
npm start
```

### 4. éªŒè¯æœåŠ¡å™¨

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:3002/health

çœ‹åˆ°ä»¥ä¸‹å“åº”è¡¨ç¤ºæˆåŠŸï¼š
```json
{
  "status": "OK",
  "message": "Google Maps APIä»£ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸",
  "timestamp": "2025-05-27T...",
  "version": "1.0.0"
}
```

---

# 2. å¯†ç è®¤è¯é…ç½®

## ğŸ” å®‰å…¨è¯´æ˜

ä¸ºäº†ä¿æŠ¤APIå…å—æœªæˆæƒè®¿é—®ï¼Œæœ¬ä»£ç†æœåŠ¡å™¨ç°å·²å®ç°å¯†ç è®¤è¯åŠŸèƒ½ã€‚æ‰€æœ‰APIç«¯ç‚¹ï¼ˆé™¤å¥åº·æ£€æŸ¥ç­‰å…¬å…±ç«¯ç‚¹å¤–ï¼‰éƒ½éœ€è¦æä¾›æ­£ç¡®çš„å¯†ç æ‰èƒ½è®¿é—®ã€‚

## å¯†ç é…ç½®

**é»˜è®¤å¯†ç **: `google-maps-proxy-2024`

**é€šè¿‡ç¯å¢ƒå˜é‡è‡ªå®šä¹‰å¯†ç **:
```powershell
# è®¾ç½®è‡ªå®šä¹‰å¯†ç 
$env:API_PASSWORD = "your-custom-password"

# å¯åŠ¨æœåŠ¡å™¨
./start.ps1
```

**Dockerç¯å¢ƒå˜é‡è®¾ç½®**:
```yaml
# docker-compose.yml
environment:
  - API_PASSWORD=your-custom-password
```

## å¯†ç ä½¿ç”¨æ–¹å¼

æ”¯æŒä»¥ä¸‹å››ç§æ–¹å¼æä¾›å¯†ç ï¼š

### 1. æŸ¥è¯¢å‚æ•°æ–¹å¼
```bash
curl "http://localhost:3002/geocode/json?address=åŒ—äº¬&password=google-maps-proxy-2024"
```

### 2. è¯·æ±‚å¤´æ–¹å¼
```bash
curl -H "X-API-Password: google-maps-proxy-2024" \
     "http://localhost:3002/geocode/json?address=åŒ—äº¬"
```

### 3. Bearer Tokenæ–¹å¼
```bash
curl -H "Authorization: Bearer google-maps-proxy-2024" \
     "http://localhost:3002/geocode/json?address=åŒ—äº¬"
```

### 4. è¯·æ±‚ä½“æ–¹å¼ï¼ˆPOSTè¯·æ±‚ï¼‰
```bash
curl -X POST "http://localhost:3002/geocode/json" \
     -H "Content-Type: application/json" \
     -d '{"address": "åŒ—äº¬", "password": "google-maps-proxy-2024"}'
```

## å¾®ä¿¡å°ç¨‹åºä¸­çš„å¯†ç ä½¿ç”¨

æ›´æ–°æ‚¨çš„APIè°ƒç”¨ä»£ç ï¼š

```javascript
// utils/GoogleMapsApi.js
function GoogleMapsApi() {
  this.baseUrl = 'http://192.168.2.132:3002'; // æ‚¨çš„æœåŠ¡å™¨IP
  this.password = 'google-maps-proxy-2024';   // APIå¯†ç 
}

GoogleMapsApi.prototype.geocode = function(address) {
  return new Promise((resolve, reject) => {
    wx.request({
      url: `${this.baseUrl}/geocode/json`,
      data: {
        address: address,
        language: 'zh-CN',
        password: this.password  // æ·»åŠ å¯†ç å‚æ•°
      },
      success: (res) => {
        if (res.data.status === 'OK') {
          resolve({
            success: true,
            data: {
              latitude: res.data.results[0].geometry.location.lat,
              longitude: res.data.results[0].geometry.location.lng
            }
          });
        } else {
          reject(new Error(res.data.error_message || 'åœ°ç†ç¼–ç å¤±è´¥'));
        }
      },
      fail: reject
    });
  });
};
```

## æ— éœ€å¯†ç çš„å…¬å…±ç«¯ç‚¹

ä»¥ä¸‹ç«¯ç‚¹æ— éœ€å¯†ç å³å¯è®¿é—®ï¼š
- `GET /health` - å¥åº·æ£€æŸ¥
- `GET /api-status` - APIçŠ¶æ€æ£€æŸ¥  
- `GET /` - APIæ–‡æ¡£å’Œç«¯ç‚¹åˆ—è¡¨

## å®‰å…¨å»ºè®®

ğŸ”’ **ç”Ÿäº§ç¯å¢ƒå®‰å…¨æé†’**ï¼š
- ä¿®æ”¹é»˜è®¤å¯†ç ä¸ºå¤æ‚å¯†ç 
- ä½¿ç”¨HTTPSä¼ è¾“å¯†ç 
- å®šæœŸæ›´æ¢å¯†ç 
- è€ƒè™‘å®æ–½IPç™½åå•
- ç›‘æ§å¼‚å¸¸è®¿é—®å°è¯•

---

# 3. Dockeréƒ¨ç½²è¯´æ˜

## ğŸ“ Dockeræ–‡ä»¶ç»“æ„

```
google-proxy-server/
â”œâ”€â”€ Dockerfile                 # å¼€å‘ç¯å¢ƒDockeré•œåƒ
â”œâ”€â”€ Dockerfile.prod           # ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–é•œåƒ
â”œâ”€â”€ docker-compose.yml        # å¼€å‘ç¯å¢ƒç¼–æ’
â”œâ”€â”€ docker-compose.prod.yml   # ç”Ÿäº§ç¯å¢ƒç¼–æ’
â”œâ”€â”€ .dockerignore             # Dockeræ„å»ºå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ .env.example              # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ nginx/
â”‚   â””â”€â”€ nginx.conf           # Nginxåå‘ä»£ç†é…ç½®
â”œâ”€â”€ docker-manage.ps1        # Dockerç®¡ç†è„šæœ¬
â””â”€â”€ quick-deploy.ps1         # å¿«é€Ÿéƒ¨ç½²è„šæœ¬
```

## ğŸš€ Dockerå¿«é€Ÿå¼€å§‹

### 1. ä¸€é”®éƒ¨ç½²ï¼ˆæ¨èæ–°æ‰‹ï¼‰

```powershell
# è¿è¡Œå¿«é€Ÿéƒ¨ç½²è„šæœ¬
.\quick-deploy.ps1
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
- æ£€æŸ¥Dockerç¯å¢ƒ
- åˆ›å»ºç¯å¢ƒé…ç½®æ–‡ä»¶
- æ„å»ºDockeré•œåƒ
- å¯åŠ¨æœåŠ¡å®¹å™¨
- è¿›è¡Œå¥åº·æ£€æŸ¥

### 2. æ‰‹åŠ¨Dockeréƒ¨ç½²

```powershell
# 1. é…ç½®ç¯å¢ƒå˜é‡
Copy-Item .env.example .env
# ç¼–è¾‘.envæ–‡ä»¶è®¾ç½®APIå¯†é’¥

# 2. æ„å»ºå¹¶å¯åŠ¨å¼€å‘ç¯å¢ƒ
docker-compose up -d

# 3. æŸ¥çœ‹çŠ¶æ€
docker-compose ps

# 4. æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

### 3. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

```powershell
# ä½¿ç”¨ç”Ÿäº§ç¯å¢ƒé…ç½®
docker-compose -f docker-compose.prod.yml build
docker-compose -f docker-compose.prod.yml up -d
```

## ğŸ› ï¸ Dockerç®¡ç†å‘½ä»¤

```powershell
# å¯åŠ¨æœåŠ¡
.\docker-manage.ps1 -Action start

# åœæ­¢æœåŠ¡
.\docker-manage.ps1 -Action stop

# é‡å¯æœåŠ¡
.\docker-manage.ps1 -Action restart

# æŸ¥çœ‹æ—¥å¿—
.\docker-manage.ps1 -Action logs

# æŸ¥çœ‹çŠ¶æ€
.\docker-manage.ps1 -Action status

# å¥åº·æ£€æŸ¥
.\docker-manage.ps1 -Action health

# æ„å»ºé•œåƒ
.\docker-manage.ps1 -Action build

# æ¸…ç†ç¯å¢ƒ
.\docker-manage.ps1 -Action clean
```

## ğŸ”§ Dockeré…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

| å˜é‡å | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|--------|
| `GOOGLE_MAPS_API_KEY` | Google Maps APIå¯†é’¥ | å¿…éœ€ |
| `API_PASSWORD` | APIè®¿é—®å¯†ç  | google-maps-proxy-2024 |
| `PORT` | æœåŠ¡ç«¯å£ | 3002 |
| `NODE_ENV` | è¿è¡Œç¯å¢ƒ | production |
| `CORS_ORIGIN` | CORSæ¥æº | * |

### ç«¯å£æ˜ å°„

- å¼€å‘ç¯å¢ƒï¼š`3002:3002`
- ç”Ÿäº§ç¯å¢ƒï¼š`80:80`, `443:443`

### å¼€å‘ç¯å¢ƒç‰¹æ€§
- åŸºäºNode.js 18 Alpine
- è‡ªåŠ¨é‡å¯
- æ—¥å¿—æŒä¹…åŒ–
- å¥åº·æ£€æŸ¥
- èµ„æºé™åˆ¶

### ç”Ÿäº§ç¯å¢ƒç‰¹æ€§
- å¤šé˜¶æ®µæ„å»ºä¼˜åŒ–
- Nginxåå‘ä»£ç†
- SSL/TLSæ”¯æŒ
- é€Ÿç‡é™åˆ¶
- å®‰å…¨åŠ å›º
- ç›‘æ§å°±ç»ª

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### å¥åº·æ£€æŸ¥

```bash
# å®¹å™¨å†…éƒ¨å¥åº·æ£€æŸ¥
wget --no-verbose --tries=1 --spider http://localhost:3002/health

# å¤–éƒ¨å¥åº·æ£€æŸ¥
curl http://localhost:3002/health
```

### æ—¥å¿—ç®¡ç†

```powershell
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose logs google-proxy

# æŸ¥çœ‹nginxæ—¥å¿—ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
docker-compose -f docker-compose.prod.yml logs nginx
```

## ğŸ”§ Dockeræ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **å®¹å™¨å¯åŠ¨å¤±è´¥**
   ```powershell
   docker-compose logs google-proxy
   ```

2. **ç«¯å£å†²çª**
   ```powershell
   netstat -ano | findstr :3002
   ```

3. **æƒé™é—®é¢˜**
   ```powershell
   # ç¡®ä¿ç”¨æˆ·åœ¨dockerç»„ä¸­
   # é‡å¯Docker Desktop
   ```

4. **ç½‘ç»œé—®é¢˜**
   ```powershell
   docker network ls
   docker network inspect google-proxy-server_google-proxy-network
   ```

### é‡ç½®ç¯å¢ƒ

```powershell
# å®Œå…¨é‡ç½®
.\docker-manage.ps1 -Action clean
docker system prune -a --volumes
```

---

# 4. æ›´æ–°æ—¥å¿—

## ğŸ”„ å®Œæˆçš„æ›´æ”¹

### 1. ç«¯å£æ›´æ”¹ (3001 â†’ 3002)
- âœ… **server.js**: æ›´æ–°ç«¯å£é…ç½®ä¸ºç¯å¢ƒå˜é‡ï¼Œé»˜è®¤3002
- âœ… **docker-compose.yml**: ç«¯å£æ˜ å°„æ›´æ–°ä¸º3002:3002
- âœ… **docker-compose.prod.yml**: ç«¯å£æ˜ å°„å’Œç¯å¢ƒå˜é‡æ›´æ–°
- âœ… **Dockerfile**: æš´éœ²ç«¯å£å’Œå¥åº·æ£€æŸ¥æ›´æ–°ä¸º3002
- âœ… **Dockerfile.prod**: æš´éœ²ç«¯å£å’Œå¥åº·æ£€æŸ¥æ›´æ–°ä¸º3002
- âœ… **nginx/nginx.conf**: ä¸Šæ¸¸æœåŠ¡å™¨ç«¯å£æ›´æ–°ä¸º3002
- âœ… **package.json**: Dockerè¿è¡Œè„šæœ¬ç«¯å£æ›´æ–°
- âœ… **start.ps1**: æ˜¾ç¤ºåœ°å€æ›´æ–°ä¸º3002
- âœ… **start.bat**: æ˜¾ç¤ºåœ°å€æ›´æ–°ä¸º3002

### 2. åŒ…ç®¡ç†å™¨æ›´æ”¹ (npm â†’ yarn)
- âœ… **Dockerfile**: å®‰è£…yarnå¹¶ä½¿ç”¨yarnå‘½ä»¤
- âœ… **Dockerfile.prod**: å®‰è£…yarnå¹¶ä½¿ç”¨yarnå‘½ä»¤
- âœ… **package.json**: Dockerè„šæœ¬æ›´æ–°ä½¿ç”¨yarn
- âœ… **start.ps1**: ä¾èµ–å®‰è£…ä½¿ç”¨yarn
- âœ… **start.bat**: ä¾èµ–å®‰è£…ä½¿ç”¨yarn
- âœ… **yarn.lock**: ç”Ÿæˆlockfileç¡®ä¿ä¾èµ–ä¸€è‡´æ€§

### 3. æ™ºèƒ½IPåœ°å€æ£€æµ‹
- âœ… **server.js**: æ·»åŠ `getIPByDefaultGateway()`å’Œ`getLocalIPAddress()`å‡½æ•°
- âœ… ä½¿ç”¨Windows routeå‘½ä»¤æ£€æµ‹çœŸå®æœ¬åœ°IP
- âœ… æ’é™¤VPNè™šæ‹Ÿç½‘ç»œåœ°å€å¹²æ‰°
- âœ… æœåŠ¡å™¨å¯åŠ¨æ—¶æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨IPåœ°å€å’Œç«¯ç‚¹

### 4. å¯†ç è®¤è¯ç³»ç»Ÿ
- âœ… **server.js**: å®ç°`validatePassword()`ä¸­é—´ä»¶
- âœ… æ”¯æŒ4ç§è®¤è¯æ–¹å¼ï¼šæŸ¥è¯¢å‚æ•°ã€è¯·æ±‚å¤´ã€Bearer Tokenã€è¯·æ±‚ä½“
- âœ… å…¬å…±ç«¯ç‚¹ï¼ˆå¥åº·æ£€æŸ¥ç­‰ï¼‰æ— éœ€å¯†ç 
- âœ… å®‰å…¨æ—¥å¿—è®°å½•è®¤è¯å¤±è´¥å°è¯•

### 5. POSTè·¯ç”±æ”¯æŒ
- âœ… ä¸ºæ‰€æœ‰7ä¸ªGoogle Maps APIç«¯ç‚¹æ·»åŠ POSTæ”¯æŒ
- âœ… æ™ºèƒ½å‚æ•°åˆå¹¶å’Œå¯†ç è¿‡æ»¤
- âœ… å®Œå…¨å…¼å®¹å¾®ä¿¡å°ç¨‹åºwx.requestè°ƒç”¨æ–¹å¼

### 6. æ–°å¢æµ‹è¯•è„šæœ¬
- âœ… **test-auth.ps1**: å¯†ç è®¤è¯æµ‹è¯•ï¼ˆ8é¡¹æµ‹è¯•ï¼‰
- âœ… **test-post-endpoints.ps1**: POSTç«¯ç‚¹æµ‹è¯•ï¼ˆ10é¡¹æµ‹è¯•ï¼‰
- âœ… **test-wechat-compatibility.ps1**: å¾®ä¿¡å°ç¨‹åºå…¼å®¹æ€§æµ‹è¯•ï¼ˆ6é¡¹æµ‹è¯•ï¼‰
- âœ… **test-ip-detection.ps1**: IPæ£€æµ‹åŠŸèƒ½æµ‹è¯•
- âœ… **verify-config.ps1**: é…ç½®éªŒè¯è„šæœ¬

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æœ¬åœ°å¼€å‘
```powershell
# ä½¿ç”¨PowerShellè„šæœ¬å¯åŠ¨
.\start.ps1

# æˆ–ç›´æ¥ä½¿ç”¨yarn
yarn start

# æˆ–ä½¿ç”¨æ‰¹å¤„ç†æ–‡ä»¶
.\start.bat
```

### Dockeréƒ¨ç½²
```powershell
# å¼€å‘ç¯å¢ƒ
docker-compose up -d

# ç”Ÿäº§ç¯å¢ƒ
docker-compose -f docker-compose.prod.yml up -d

# å¿«é€Ÿéƒ¨ç½²
.\quick-deploy.ps1
```

### æµ‹è¯•éªŒè¯
```powershell
# å¯†ç è®¤è¯æµ‹è¯•
.\test-auth.ps1

# POSTç«¯ç‚¹æµ‹è¯•
.\test-post-endpoints.ps1

# å¾®ä¿¡å…¼å®¹æ€§æµ‹è¯•
.\test-wechat-compatibility.ps1

# é…ç½®éªŒè¯
.\verify-config.ps1
```

---

# 5. é¡¹ç›®å®ŒæˆçŠ¶æ€æ€»ç»“

## ğŸ“‹ ä»»åŠ¡å®Œæˆæƒ…å†µ

### âœ… å·²å®Œæˆçš„ä¸»è¦ä»»åŠ¡

#### 1. Dockeré…ç½®ä¼˜åŒ– âœ…
- **åŒ…ç®¡ç†å™¨åˆ‡æ¢**: ä»npmå®Œå…¨è¿ç§»åˆ°yarn
  - æ›´æ–°äº†æ‰€æœ‰Dockerfileæ–‡ä»¶
  - ä¿®æ”¹äº†æ‰€æœ‰å¯åŠ¨è„šæœ¬
  - ç”Ÿæˆäº†yarn.lockæ–‡ä»¶ç¡®ä¿ä¾èµ–ä¸€è‡´æ€§
- **ç«¯å£é…ç½®**: ä»3001ç»Ÿä¸€å‡çº§åˆ°3002
  - æ›´æ–°äº†æ‰€æœ‰é…ç½®æ–‡ä»¶
  - ä¿®æ”¹äº†Docker composeæ–‡ä»¶
  - æ›´æ–°äº†nginxé…ç½®
  - ä¿®æ­£äº†æ‰€æœ‰æ–‡æ¡£ä¸­çš„ç«¯å£å¼•ç”¨

#### 2. æ™ºèƒ½IPåœ°å€æ£€æµ‹ âœ…
- **çœŸå®IPæ£€æµ‹**: å®ç°äº†`getIPByDefaultGateway()`å‡½æ•°
  - ä½¿ç”¨Windows routeå‘½ä»¤æ£€æµ‹é»˜è®¤ç½‘å…³
  - è‡ªåŠ¨è¯†åˆ«çœŸå®æœ¬åœ°ç½‘ç»œIPï¼ˆ192.168.2.132ï¼‰
  - æ’é™¤VPNè™šæ‹Ÿç½‘ç»œåœ°å€ï¼ˆ198.18.0.1ï¼‰
- **å¢å¼ºå¯åŠ¨ä¿¡æ¯**: æœåŠ¡å™¨å¯åŠ¨æ—¶æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨IPåœ°å€

#### 3. å¯†ç è®¤è¯ç³»ç»Ÿ âœ…
- **å®Œæ•´çš„å¯†ç ä¿æŠ¤**: å®ç°äº†`validatePassword()`ä¸­é—´ä»¶
- **å¤šç§è®¤è¯æ–¹å¼**æ”¯æŒï¼š
  1. æŸ¥è¯¢å‚æ•°: `?password=xxx`
  2. è¯·æ±‚å¤´: `X-API-Password: xxx`
  3. Bearer Token: `Authorization: Bearer xxx`
  4. è¯·æ±‚ä½“: `{"password": "xxx"}`
- **å…¬å…±ç«¯ç‚¹**: å¥åº·æ£€æŸ¥ç­‰ä¸éœ€è¦å¯†ç çš„ç«¯ç‚¹
- **å®‰å…¨æ—¥å¿—**: è®°å½•è®¤è¯å¤±è´¥å°è¯•

#### 4. POSTè·¯ç”±æ”¯æŒ âœ…
- **å®Œæ•´POSTå®ç°**: ä¸ºæ‰€æœ‰7ä¸ªGoogle Maps APIç«¯ç‚¹æ·»åŠ POSTæ”¯æŒ
  - `/geocode/json`
  - `/place/autocomplete/json`
  - `/place/details/json`
  - `/place/nearbysearch/json`
  - `/place/textsearch/json`
  - `/distancematrix/json`
  - `/directions/json`
- **å‚æ•°åˆå¹¶**: æ™ºèƒ½åˆå¹¶æŸ¥è¯¢å‚æ•°å’Œè¯·æ±‚ä½“å‚æ•°
- **å¯†ç è¿‡æ»¤**: åœ¨è½¬å‘ç»™Google APIå‰è‡ªåŠ¨ç§»é™¤å¯†ç å‚æ•°

#### 5. å¾®ä¿¡å°ç¨‹åºå…¼å®¹æ€§ âœ…
- **å®Œå…¨å…¼å®¹**: æ”¯æŒå¾®ä¿¡å°ç¨‹åºçš„wx.requestè°ƒç”¨æ–¹å¼
- **GET/POSTåŒæ”¯æŒ**: æ—¢æ”¯æŒä¼ ç»ŸGETè¯·æ±‚ï¼Œä¹Ÿæ”¯æŒPOSTè¯·æ±‚
- **ä»£ç ç¤ºä¾‹**: æä¾›äº†å®Œæ•´çš„å¾®ä¿¡å°ç¨‹åºé›†æˆä»£ç 

#### 6. å…¨é¢æµ‹è¯•å¥—ä»¶ âœ…
- **å¯†ç è®¤è¯æµ‹è¯•**: `test-auth.ps1` - 8ä¸ªæµ‹è¯•å…¨éƒ¨é€šè¿‡
- **POSTç«¯ç‚¹æµ‹è¯•**: `test-post-endpoints.ps1` - 10ä¸ªæµ‹è¯•å…¨éƒ¨é€šè¿‡  
- **å¾®ä¿¡å…¼å®¹æ€§æµ‹è¯•**: `test-wechat-compatibility.ps1` - 6ä¸ªæµ‹è¯•å…¨éƒ¨é€šè¿‡
- **IPæ£€æµ‹æµ‹è¯•**: `test-ip-detection.ps1`
- **é…ç½®éªŒè¯**: `verify-config.ps1`

## ğŸ“Š æµ‹è¯•ç»“æœæ‘˜è¦

| æµ‹è¯•ç±»åˆ« | æµ‹è¯•è„šæœ¬ | æµ‹è¯•æ•°é‡ | é€šè¿‡ç‡ | çŠ¶æ€ |
|---------|---------|---------|-------|------|
| å¯†ç è®¤è¯ | test-auth.ps1 | 8 | 100% | âœ… å®Œç¾ |
| POSTç«¯ç‚¹ | test-post-endpoints.ps1 | 10 | 100% | âœ… å®Œç¾ |
| å¾®ä¿¡å…¼å®¹ | test-wechat-compatibility.ps1 | 6 | 100% | âœ… å®Œç¾ |
| **æ€»è®¡** | **3ä¸ªæµ‹è¯•å¥—ä»¶** | **24** | **100%** | **âœ… å…¨éƒ¨é€šè¿‡** |

## ğŸš€ å½“å‰è¿è¡ŒçŠ¶æ€

- **æœåŠ¡å™¨çŠ¶æ€**: âœ… æ­£å¸¸è¿è¡Œ
- **ç«¯å£**: 3002
- **æ£€æµ‹IP**: 192.168.2.132ï¼ˆçœŸå®æœ¬åœ°IPï¼‰
- **å¯†ç è®¤è¯**: âœ… å·²å¯ç”¨ (é»˜è®¤: google-maps-proxy-2024)
- **POSTæ”¯æŒ**: âœ… æ‰€æœ‰ç«¯ç‚¹å·²æ”¯æŒ
- **å¾®ä¿¡å…¼å®¹**: âœ… å®Œå…¨å…¼å®¹

## ğŸ“ é…ç½®æ–‡ä»¶æ›´æ–°çŠ¶æ€

| æ–‡ä»¶ | æ›´æ–°å†…å®¹ | çŠ¶æ€ |
|-----|---------|------|
| `server.js` | ç«¯å£ã€IPæ£€æµ‹ã€å¯†ç è®¤è¯ã€POSTè·¯ç”± | âœ… å®Œæˆ |
| `package.json` | Dockerè„šæœ¬ï¼Œç«¯å£é…ç½® | âœ… å®Œæˆ |
| `Dockerfile` | yarnå®‰è£…ï¼Œç«¯å£3002ï¼Œå¥åº·æ£€æŸ¥ | âœ… å®Œæˆ |
| `Dockerfile.prod` | yarnå®‰è£…ï¼Œç«¯å£3002ï¼Œå¥åº·æ£€æŸ¥ | âœ… å®Œæˆ |
| `docker-compose.yml` | ç«¯å£æ˜ å°„ï¼ŒAPI_PASSWORDç¯å¢ƒå˜é‡ | âœ… å®Œæˆ |
| `docker-compose.prod.yml` | ç«¯å£æ˜ å°„ï¼ŒAPI_PASSWORDç¯å¢ƒå˜é‡ | âœ… å®Œæˆ |
| `nginx/nginx.conf` | upstreamç«¯å£æ›´æ–° | âœ… å®Œæˆ |
| `start.ps1` | yarnä½¿ç”¨ï¼Œç«¯å£æ˜¾ç¤º | âœ… å®Œæˆ |
| `start.bat` | yarnä½¿ç”¨ï¼Œç«¯å£æ˜¾ç¤º | âœ… å®Œæˆ |
| `README.md` | å®Œæ•´æ–‡æ¡£æ›´æ–°ï¼Œå¯†ç è®¤è¯è¯´æ˜ | âœ… å®Œæˆ |
| `config.json` | ç«¯å£3002 | âœ… å®Œæˆ |
| `.env` & `.env.example` | PORT=3002 | âœ… å®Œæˆ |

## ğŸ” å®‰å…¨ç‰¹æ€§

- **å¯†ç ä¿æŠ¤**: æ‰€æœ‰APIç«¯ç‚¹ï¼ˆé™¤å…¬å…±ç«¯ç‚¹å¤–ï¼‰éƒ½éœ€è¦å¯†ç è®¤è¯
- **å¤šç§è®¤è¯æ–¹å¼**: æ”¯æŒæŸ¥è¯¢å‚æ•°ã€è¯·æ±‚å¤´ã€Bearer tokenã€è¯·æ±‚ä½“
- **å®‰å…¨æ—¥å¿—**: è®°å½•è®¤è¯å¤±è´¥å°è¯•ï¼Œå¯†ç ä¿¡æ¯è¢«é®æ©
- **å…¬å…±ç«¯ç‚¹**: å¥åº·æ£€æŸ¥ç­‰ç®¡ç†ç«¯ç‚¹æ— éœ€å¯†ç 
- **ç¯å¢ƒå˜é‡**: æ”¯æŒé€šè¿‡ç¯å¢ƒå˜é‡è‡ªå®šä¹‰å¯†ç 

## ğŸ¯ å¾®ä¿¡å°ç¨‹åºé›†æˆ

- **å®Œå…¨å…¼å®¹**: æ”¯æŒwx.requestçš„æ ‡å‡†è°ƒç”¨æ–¹å¼
- **GET/POSTåŒæ”¯æŒ**: çµæ´»çš„è¯·æ±‚æ–¹å¼é€‰æ‹©
- **å¯†ç é›†æˆ**: åœ¨dataå‚æ•°ä¸­ä¼ é€’å¯†ç å³å¯
- **é”™è¯¯å¤„ç†**: å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œå“åº”è§£æ
- **ä»£ç ç¤ºä¾‹**: æä¾›å®Œæ•´çš„GoogleMapsApi.jså®ç°

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

- **yarnåŒ…ç®¡ç†**: æ›´å¿«çš„ä¾èµ–å®‰è£…å’Œæ›´ä¸€è‡´çš„lockfile
- **Dockerå¤šé˜¶æ®µæ„å»º**: ç”Ÿäº§ç¯å¢ƒé•œåƒä¼˜åŒ–
- **æ™ºèƒ½IPæ£€æµ‹**: é¿å…VPNç½‘ç»œå¹²æ‰°ï¼Œç¡®ä¿å±€åŸŸç½‘è®¿é—®
- **å¥åº·æ£€æŸ¥**: Dockerå®¹å™¨è‡ªåŠ¨å¥åº·ç›‘æ§

## ğŸ”„ éƒ¨ç½²é€‰é¡¹

1. **æœ¬åœ°å¼€å‘**: `.\start.ps1` æˆ– `yarn start`
2. **Dockerå¼€å‘**: `docker-compose up -d`
3. **Dockerç”Ÿäº§**: `docker-compose -f docker-compose.prod.yml up -d`
4. **å¿«é€Ÿéƒ¨ç½²**: `.\quick-deploy.ps1`

## âš¡ å¿«é€ŸéªŒè¯å‘½ä»¤

```powershell
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
curl http://localhost:3002/health

# æµ‹è¯•å¯†ç è®¤è¯
.\test-auth.ps1

# æµ‹è¯•POSTç«¯ç‚¹
.\test-post-endpoints.ps1

# æµ‹è¯•å¾®ä¿¡å…¼å®¹æ€§
.\test-wechat-compatibility.ps1

# æ£€æŸ¥ç«¯å£å ç”¨
netstat -ano | findstr :3002
```

## ğŸ† é¡¹ç›®æ€»ç»“

æœ¬é¡¹ç›®å·²æˆåŠŸå®Œæˆæ‰€æœ‰é¢„å®šç›®æ ‡ï¼š

1. âœ… **Dockeré…ç½®ç°ä»£åŒ–** - è¿ç§»åˆ°yarnï¼Œç«¯å£å‡çº§
2. âœ… **æ™ºèƒ½ç½‘ç»œæ£€æµ‹** - çœŸå®IPæ£€æµ‹ï¼Œé¿å…VPNå¹²æ‰°  
3. âœ… **å®Œæ•´å®‰å…¨é˜²æŠ¤** - å¤šæ–¹å¼å¯†ç è®¤è¯ç³»ç»Ÿ
4. âœ… **åŠŸèƒ½å¢å¼º** - POSTè·¯ç”±æ”¯æŒï¼Œæå‡çµæ´»æ€§
5. âœ… **å¾®ä¿¡å…¼å®¹** - å®Œç¾æ”¯æŒå¾®ä¿¡å°ç¨‹åºé›†æˆ
6. âœ… **å…¨é¢æµ‹è¯•** - 24é¡¹æµ‹è¯•100%é€šè¿‡ç‡

**å½“å‰çŠ¶æ€**: ğŸš€ **ç”Ÿäº§å°±ç»ª** - æ‰€æœ‰åŠŸèƒ½å·²å®Œæˆå¹¶ç»è¿‡å……åˆ†æµ‹è¯•ï¼Œå¯ä»¥å®‰å…¨éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚

---

**å®Œæˆæ—¶é—´**: 2025å¹´5æœˆ27æ—¥  
**å¼€å‘è€…**: é«˜çº§ä¸­å›½å…¨æ ˆå·¥ç¨‹å¸ˆ  
**é¡¹ç›®ç‰ˆæœ¬**: v2.0.0 (å®Œæ•´åŠŸèƒ½ç‰ˆ)

---

## ğŸ“š æ›´å¤šèµ„æº

- [Dockerå®˜æ–¹æ–‡æ¡£](https://docs.docker.com/)
- [Docker Composeæ–‡æ¡£](https://docs.docker.com/compose/)
- [Google Maps APIæ–‡æ¡£](https://developers.google.com/maps/documentation)
- [å¾®ä¿¡å°ç¨‹åºå¼€å‘æ–‡æ¡£](https://developers.weixin.qq.com/miniprogram/dev/)
